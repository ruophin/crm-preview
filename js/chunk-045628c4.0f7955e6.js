(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-045628c4"],{"5a0c":function(t,e,n){!function(e,n){t.exports=n()}(0,(function(){"use strict";var t=1e3,e=6e4,n=36e5,s="millisecond",a="second",i="minute",r="hour",o="day",l="week",u="month",c="quarter",d="year",f="date",h="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},w=function(t,e,n){var s=String(t);return!s||s.length>=e?t:""+Array(e+1-s.length).join(n)+t},g={s:w,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),s=Math.floor(n/60),a=n%60;return(e<=0?"+":"-")+w(s,2,"0")+":"+w(a,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var s=12*(n.year()-e.year())+(n.month()-e.month()),a=e.clone().add(s,u),i=n-a<0,r=e.clone().add(s+(i?-1:1),u);return+(-(s+(n-a)/(i?a-r:r-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:d,w:l,d:o,D:f,h:r,m:i,s:a,ms:s,Q:c}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},v="en",b={};b[v]=m;var y=function(t){return t instanceof D},$=function(t,e,n){var s;if(!t)return v;if("string"==typeof t)b[t]&&(s=t),e&&(b[t]=e,s=t);else{var a=t.name;b[a]=t,s=a}return!n&&s&&(v=s),s||!n&&v},x=function(t,e){if(y(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new D(n)},S=g;S.l=$,S.i=y,S.w=function(t,e){return x(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var D=function(){function m(t){this.$L=$(t.locale,null,!0),this.parse(t)}var w=m.prototype;return w.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(S.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var s=e.match(_);if(s){var a=s[2]-1||0,i=(s[7]||"0").substring(0,3);return n?new Date(Date.UTC(s[1],a,s[3]||1,s[4]||0,s[5]||0,s[6]||0,i)):new Date(s[1],a,s[3]||1,s[4]||0,s[5]||0,s[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},w.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},w.$utils=function(){return S},w.isValid=function(){return!(this.$d.toString()===h)},w.isSame=function(t,e){var n=x(t);return this.startOf(e)<=n&&n<=this.endOf(e)},w.isAfter=function(t,e){return x(t)<this.startOf(e)},w.isBefore=function(t,e){return this.endOf(e)<x(t)},w.$g=function(t,e,n){return S.u(t)?this[e]:this.set(n,t)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(t,e){var n=this,s=!!S.u(e)||e,c=S.p(t),h=function(t,e){var a=S.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return s?a:a.endOf(o)},_=function(t,e){return S.w(n.toDate()[t].apply(n.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},p=this.$W,m=this.$M,w=this.$D,g="set"+(this.$u?"UTC":"");switch(c){case d:return s?h(1,0):h(31,11);case u:return s?h(1,m):h(0,m+1);case l:var v=this.$locale().weekStart||0,b=(p<v?p+7:p)-v;return h(s?w-b:w+(6-b),m);case o:case f:return _(g+"Hours",0);case r:return _(g+"Minutes",1);case i:return _(g+"Seconds",2);case a:return _(g+"Milliseconds",3);default:return this.clone()}},w.endOf=function(t){return this.startOf(t,!1)},w.$set=function(t,e){var n,l=S.p(t),c="set"+(this.$u?"UTC":""),h=(n={},n[o]=c+"Date",n[f]=c+"Date",n[u]=c+"Month",n[d]=c+"FullYear",n[r]=c+"Hours",n[i]=c+"Minutes",n[a]=c+"Seconds",n[s]=c+"Milliseconds",n)[l],_=l===o?this.$D+(e-this.$W):e;if(l===u||l===d){var p=this.clone().set(f,1);p.$d[h](_),p.init(),this.$d=p.set(f,Math.min(this.$D,p.daysInMonth())).$d}else h&&this.$d[h](_);return this.init(),this},w.set=function(t,e){return this.clone().$set(t,e)},w.get=function(t){return this[S.p(t)]()},w.add=function(s,c){var f,h=this;s=Number(s);var _=S.p(c),p=function(t){var e=x(h);return S.w(e.date(e.date()+Math.round(t*s)),h)};if(_===u)return this.set(u,this.$M+s);if(_===d)return this.set(d,this.$y+s);if(_===o)return p(1);if(_===l)return p(7);var m=(f={},f[i]=e,f[r]=n,f[a]=t,f)[_]||1,w=this.$d.getTime()+s*m;return S.w(w,this)},w.subtract=function(t,e){return this.add(-1*t,e)},w.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var s=t||"YYYY-MM-DDTHH:mm:ssZ",a=S.z(this),i=this.$H,r=this.$m,o=this.$M,l=n.weekdays,u=n.months,c=function(t,n,a,i){return t&&(t[n]||t(e,s))||a[n].substr(0,i)},d=function(t){return S.s(i%12||12,t,"0")},f=n.meridiem||function(t,e,n){var s=t<12?"AM":"PM";return n?s.toLowerCase():s},_={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:S.s(o+1,2,"0"),MMM:c(n.monthsShort,o,u,3),MMMM:c(u,o),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:c(n.weekdaysMin,this.$W,l,2),ddd:c(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(i),HH:S.s(i,2,"0"),h:d(1),hh:d(2),a:f(i,r,!0),A:f(i,r,!1),m:String(r),mm:S.s(r,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:a};return s.replace(p,(function(t,e){return e||_[t]||a.replace(":","")}))},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(s,f,h){var _,p=S.p(f),m=x(s),w=(m.utcOffset()-this.utcOffset())*e,g=this-m,v=S.m(this,m);return v=(_={},_[d]=v/12,_[u]=v,_[c]=v/3,_[l]=(g-w)/6048e5,_[o]=(g-w)/864e5,_[r]=g/n,_[i]=g/e,_[a]=g/t,_)[p]||g,h?v:S.a(v)},w.daysInMonth=function(){return this.endOf(u).$D},w.$locale=function(){return b[this.$L]},w.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),s=$(t,e,!0);return s&&(n.$L=s),n},w.clone=function(){return S.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},m}(),k=D.prototype;return x.prototype=k,[["$ms",s],["$s",a],["$m",i],["$H",r],["$W",o],["$M",u],["$y",d],["$D",f]].forEach((function(t){k[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),x.extend=function(t,e){return t.$i||(t(e,D,x),t.$i=!0),x},x.locale=$,x.isDayjs=y,x.unix=function(t){return x(1e3*t)},x.en=b[v],x.Ls=b,x.p={},x}))},c8b2:function(t,e,n){},cd3f:function(t,e,n){"use strict";var s=n("c8b2"),a=n.n(s);a.a},d6b7:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("div",{staticClass:"header_view"},[n("el-form",{attrs:{"label-width":"auto"}},[n("el-row",[n("el-radio-group",{staticStyle:{padding:"10px 0"},attrs:{size:"small"},on:{change:t.handledRadio},model:{value:t.radioKey,callback:function(e){t.radioKey=e},expression:"radioKey"}},[n("el-radio-button",{attrs:{label:0}},[t._v("待处理")]),n("el-radio-button",{attrs:{label:1}},[t._v("已处理")])],1)],1),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{xs:10,sm:10,md:5,lg:5,xl:5}},[n("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{"label-width":"0"}},[n("el-input",{attrs:{placeholder:"输入患者姓名/用户昵称/手机号查找"},nativeOn:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handledSearch(e)}},model:{value:t.searchResult,callback:function(e){t.searchResult="string"===typeof e?e.trim():e},expression:"searchResult"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})])],1)],1),n("el-col",{attrs:{xs:12,sm:12,md:10,lg:8,xl:6}},[n("el-form-item",{staticStyle:{"margin-bottom":"0px","margin-left":"0px"},attrs:{label:"到期日期："}},[n("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.handledOptions},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1),n("el-col",{attrs:{xs:10,sm:10,md:8,lg:4,xl:3}},[n("el-form-item",{staticStyle:{"margin-bottom":"0px","margin-left":"0px"},attrs:{label:"达标情况："}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"达标情况"},on:{change:t.handledOptions},model:{value:t.isStandards,callback:function(e){t.isStandards=e},expression:"isStandards"}},[n("el-option",{attrs:{label:"全部",value:""}}),n("el-option",{attrs:{label:"已达标",value:1}}),n("el-option",{attrs:{label:"未达标",value:2}})],1)],1)],1),1===t.radioKey?n("el-col",{attrs:{xs:10,sm:10,md:8,lg:4,xl:3}},[n("el-form-item",{staticStyle:{"margin-bottom":"0px","margin-left":"0px",display:"inline-block"},attrs:{label:"跟进结果："}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"达标情况"},on:{change:t.handledOptions},model:{value:t.isFollowUp,callback:function(e){t.isFollowUp=e},expression:"isFollowUp"}},[n("el-option",{attrs:{label:"全部",value:""}}),n("el-option",{attrs:{label:"启动下一疗程",value:7}}),n("el-option",{attrs:{label:"已购买",value:5}}),n("el-option",{attrs:{label:"意向退货",value:1}}),n("el-option",{attrs:{label:"已退货",value:6}}),n("el-option",{attrs:{label:"考虑中",value:2}}),n("el-option",{attrs:{label:"未回复",value:3}}),n("el-option",{attrs:{label:"结束",value:4}})],1)],1)],1):t._e(),n("el-col",{staticStyle:{margin:"8px 0",float:"right"},attrs:{span:6}},[n("el-button",{staticStyle:{float:"right","margin-left":"20px"},attrs:{type:"primary"},on:{click:t.handledOptions}},[t._v("查询")]),n("el-button",{staticStyle:{float:"right","margin-left":"0"},on:{click:t.handledReset}},[t._v("重置")])],1)],1),1===t.radioKey&&t.count_info?n("el-row",[n("el-col",{attrs:{sm:2,md:2,lg:2,xl:2}},[n("p",{staticClass:"f14"},[t._v("全部："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.total||0))])])]),n("el-col",{attrs:{sm:4,md:4,lg:3,xl:3}},[n("p",{staticClass:"f14"},[t._v("启动下一疗程："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.start_next_total||0))])])]),n("el-col",{attrs:{sm:3,md:3,lg:3,xl:2}},[n("p",{staticClass:"f14"},[t._v("已购买："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.bought_total||0))])])]),n("el-col",{attrs:{sm:3,md:3,lg:3,xl:2}},[n("p",{staticClass:"f14"},[t._v("意向退货："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.intention_return_total||0))])])]),n("el-col",{attrs:{sm:3,md:3,lg:3,xl:2}},[n("p",{staticClass:"f14"},[t._v("已退货："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.returned_total||0))])])]),n("el-col",{attrs:{sm:3,md:3,lg:3,xl:2}},[n("p",{staticClass:"f14"},[t._v("考虑中："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.considering_total||0))])])]),n("el-col",{attrs:{sm:3,md:3,lg:3,xl:2}},[n("p",{staticClass:"f14"},[t._v("未回复："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.no_reply_total||0))])])]),n("el-col",{attrs:{sm:3,md:3,lg:3,xl:2}},[n("p",{staticClass:"f14"},[t._v("结束："),n("span",{staticClass:"orange f16 bold"},[t._v(t._s(t.count_info.end_total||0))])])])],1):t._e()],1)],1),n("div",{staticStyle:{margin:"0 16px","padding-top":"16px"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"elTable",attrs:{data:t.tableData,size:"small",border:"",stripe:"",height:t.table_height}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center",index:function(e){return(t.page-1)*t.size+e+1}}}),n("el-table-column",{attrs:{prop:"name",label:"患者信息","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"blue",on:{click:function(n){return t.pushCarePlan(e.row)}}},[t._v(t._s(e.row.patient_name||"--"))]),n("br"),n("span",{staticClass:"gray"},[t._v(t._s(0==e.row.sex?"男":1==e.row.sex?"女":"--")+" / "+t._s(e.row.age)+"岁")]),n("br"),n("span",[t._v("建档时间："+t._s(e.row.patient_create_time&&e.row.patient_create_time.split(" ")[0]||"--"))])]}}])}),n("el-table-column",{attrs:{prop:"name",label:"用户信息","min-width":"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v("unionid："+t._s(e.row.union_id||"--"))]),e.row.union_id?n("a",{staticClass:"ml10 blue",on:{click:function(n){return t.copyText(e.row.union_id)}}},[t._v("复制")]):t._e(),n("br"),n("span",[t._v("昵 称："),n("a",{staticClass:"blue",on:{click:function(n){return t.pushUseDetail(e.row)}}},[t._v(t._s(e.row.nickname||"--"))]),n("br")]),n("span",[t._v("手机号："),n("a",{staticClass:"blue",on:{click:function(n){return t.pushUseDetail(e.row)}}},[t._v(t._s(e.row.phone||"--"))])]),n("br"),n("span",[t._v("与患者关系："+t._s(e.row.relation||"--"))])]}}])}),n("el-table-column",{attrs:{label:"服务信息","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v("服务号："+t._s(e.row.subscribe_official_account?"已关注":"未关注")),n("br")]),n("span",[t._v("企微好友："+t._s(e.row.subscribe_qywx?"已添加":"未添加")),n("br")]),e.row.subscribe_qywx?n("span",[t._v("企微客服昵称："+t._s(e.row.qy_userid||"--")),n("br")]):t._e()]}}])}),n("el-table-column",{attrs:{prop:"sex",label:"入组信息","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.status?n("div",[n("span",[t._v("医生："+t._s(e.row.contract_doctor_name||"--")),n("br")]),n("span",[t._v("医院："+t._s(e.row.dept_name||"--")),n("br")]),n("span",[t._v("门诊号："+t._s(e.row.menzhen_number||"--"))]),e.row.menzhen_number?n("a",{staticClass:"ml10 blue",on:{click:function(n){return t.copyText(e.row.menzhen_number)}}},[t._v("复制")]):t._e(),n("br"),n("span",[t._v("入组时间："+t._s(e.row.in_time&&e.row.in_time.split(" ")[0]||"--"))])]):n("span",[t._v("--")])]}}])}),n("el-table-column",{attrs:{label:"疗程信息","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.start_time?n("span",[n("span",[t._v("第"+t._s(e.row.number||1)+"疗程 ")]),t._v(" 第"+t._s(e.row.days)+"天 "),n("i",{class:{orange:e.row.apply_close_step<4,red:3==e.row.status}},[t._v(t._s(t.step_dict[e.row.apply_close_step]))]),2==e.row.status?n("i",{staticClass:"red"},[t._v("疗程已结束")]):t._e(),n("br")]):t._e(),e.row.pastDue>0?n("span",[t._v("还有 "),n("i",{staticClass:"orange"},[t._v(t._s(e.row.pastDue))]),t._v(" 天到期"),n("br")]):t._e(),e.row.pastDue<=0?n("span",{staticClass:"red"},[t._v("已逾期 "+t._s(Math.abs(e.row.pastDue))+" 天"),n("br")]):t._e(),e.row.start_time?n("span",[t._v(t._s(e.row.start_time&&e.row.start_time.split(" ")[0])+" 至 "+t._s(e.row.actual_end_time&&e.row.actual_end_time.split(" ")[0]||e.row.end_time&&e.row.end_time.split(" ")[0])),n("br")]):n("span",[t._v("--")]),e.row.start_next_flag?n("span",{staticClass:"light-blue"},[t._v("已启动下一个疗程")]):t._e()]}}])}),n("el-table-column",{attrs:{label:"达标率","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.status?[n("span",{class:{green:e.row.standard,red:!e.row.standard},staticStyle:{"font-weight":"600","line-height":"22px"}},[t._v(t._s(e.row.standard?"达标":"未达标"))]),n("br"),n("span",[t._v("日间 PEF："),n("i",{class:{green:e.row.pef_qualified_rate>=90,red:e.row.pef_qualified_rate&&e.row.pef_qualified_rate<80,orange:e.row.pef_qualified_rate>=80&&e.row.pef_qualified_rate<90}},[t._v(t._s(e.row.pef_qualified_rate&&e.row.pef_qualified_rate+"%"||"--"))]),n("br")]),n("span",[t._v("每日用药："),n("i",{class:{green:e.row.drug_qualified_rate>=90,red:e.row.drug_qualified_rate&&e.row.drug_qualified_rate<80,orange:e.row.drug_qualified_rate>=80&&e.row.drug_qualified_rate<90}},[t._v(t._s(e.row.drug_qualified_rate&&e.row.drug_qualified_rate+"%"||"--"))]),n("br")]),n("span",[t._v("随访服务："),n("i",{class:100==e.row.followup_qualified_rate?"green":e.row.followup_qualified_rate?"red":""},[t._v(t._s(e.row.followup_qualified_rate&&e.row.followup_qualified_rate+"%"||"--"))]),n("br")])]:n("span",[t._v("--")])]}}])}),n("el-table-column",{attrs:{label:"绑定设备信息","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(2==e.row.state?"已租赁":3==e.row.state?"已购买":""))]),n("br"),e.row.goods_name&&e.row.sn_num?n("span",[n("a",{class:{blue:e.row.goods_name&&e.row.sn_num},on:{click:function(n){return t.pushStorage(e.row)}}},[t._v(" "+t._s(e.row.goods_name&&e.row.sn_num?e.row.goods_name:"--")+t._s(e.row.goods_name&&e.row.sn_num?"：":"")+t._s(e.row.sn_num)+" ")])]):t._e()]}}])}),1===t.radioKey?n("el-table-column",{attrs:{label:"跟进结果","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{class:{red:1==e.row.follow_result},staticStyle:{"font-weight":"600","line-height":"26px"}},[t._v(t._s(t.followResult[e.row.follow_result-1]))]),n("br"),e.row.follow_result<5?n("span",[t._v("备注："+t._s(e.row.follow_remark||"--")),n("br")]):t._e(),5==e.row.follow_result?n("span",[n("a",{staticClass:"blue",on:{click:function(n){return t.pushUseDetail(e.row)}}},[t._v(t._s(e.row.goods_name)+"："+t._s(e.row.sn_num||"--"))]),n("br")]):t._e(),7==e.row.follow_result?n("span",[t._v("疗程信息："+t._s(e.row.next_start_time?e.row.next_start_time.split(" ")[0]:"--")+" 至 "+t._s(e.row.next_end_time?e.row.next_end_time.split(" ")[0]:"--")),n("br")]):t._e(),n("span",[t._v(t._s(t.followTitle(e.row.follow_result))+t._s(e.row.follow_time||"--"))]),n("br"),6==e.row.follow_result?n("span",[t._v("操作人："+t._s(e.row.operate_name||"--"))]):t._e()]}}],null,!1,3504353082)}):t._e(),n("el-table-column",{attrs:{label:"操作","min-width":"120",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-link",{attrs:{disabled:!e.row.status||!e.row.patient_id,underline:!1,type:"primary"},on:{click:function(n){return t.writeFllowResult(e.row)}}},[t._v(" 填写跟进结果 ")])]}}])})],1)],1),n("div",{staticStyle:{margin:"10px 16px 0px"},attrs:{align:"right"}},[n("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[20,50,100,200],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total_count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),n("input",{staticStyle:{position:"absolute",left:"-999px"},attrs:{type:"text",id:"input"}}),n("el-dialog",{attrs:{title:"填写跟进结果",width:"30%","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"before-close":t.followCancel,visible:t.followUpVisible},on:{"update:visible":function(e){t.followUpVisible=e}}},[n("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{label:"跟进情况",prop:"followUp","label-width":"85px"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},on:{change:t.handledFollowUp},model:{value:t.form.followUp,callback:function(e){t.$set(t.form,"followUp",e)},expression:"form.followUp"}},[n("el-option",{attrs:{label:"意向退货",value:1}}),n("el-option",{attrs:{label:"考虑中",value:2}}),n("el-option",{attrs:{label:"未回复",value:3}}),n("el-option",{attrs:{label:"结束",value:4}})],1)],1),n("el-form-item",{attrs:{label:"备注",prop:"remark","label-width":"85px"}},[n("el-input",{attrs:{type:"textarea",placeholder:"请填写备注",maxlength:"30",size:"medium","show-word-limit":"",autosize:{minRows:3,maxRows:6},autocomplete:"off"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.followCancel}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.followConfirm}},[t._v("确 定")])],1)],1)],1)},a=[],i=(n("d81d"),n("96cf"),n("1da1")),r=n("5a0c"),o=n.n(r),l=n("d772"),u=n.n(l);o.a.extend(u.a);var c={name:"index",data:function(){return{radioKey:0,searchResult:"",isStandards:"",dateRange:[],isFollowUp:"",followUpResult:"",tableLoading:!0,tableData:[],total_count:0,page:1,size:20,followUpVisible:!1,plan_info:"",table_height:"calc(100vh - 288px)",windowWidth:0,step_dict:{1:"申请结束疗程",2:"设备退还",3:"租金核算并退款",4:"疗程已结束"},form:{followUp:"",remark:""},rules:{followUp:[{required:!1,message:"请选择跟进情况",trigger:"change"}],remark:[{required:!1}]},count_info:{},followResult:["意向退货","考虑中","未回复","结束","已购买","已退货","启动下个疗程"]}},watch:{windowWidth:{immediate:!0,deep:!0,handler:function(t){1==this.radioKey&&(t>=1920&&(this.table_height="calc(100vh - 320px)"),t<1920&&(this.table_height="calc(100vh - 348px)")),console.log("实时屏幕宽度：",t)}}},created:function(){var t=new Date;t.setDate(t.getDate()+5),this.dateRange=[new Date,t],this.fetchCarePlanRemind()},mounted:function(){var t=this;window.onresize=function(){return function(){window.fullWidth=document.documentElement.clientWidth,t.windowWidth=window.fullWidth}()}},methods:{fetchCarePlanRemind:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dateRange&&t.dateRange.length&&(n=o()(t.dateRange[0]).format("YYYY-MM-DD")+" 00:00:00",s=o()(t.dateRange[1]).format("YYYY-MM-DD")+" 23:59:59"),e.next=3,t.$api.asthma.care_plan_remind({find_key:t.searchResult?t.searchResult:void 0,follow_result:t.isFollowUp?t.isFollowUp:void 0,page:t.page,qualified:t.isStandards?t.isStandards:void 0,size:t.size,start_date:n,end_date:s,type:t.radioKey});case 3:a=e.sent,i=a.data,t.tableData=i.data.page_info_vo.list,t.tableData.map((function(t){var e=t.actual_end_time||t.end_time;t.days=0,t.standard=parseFloat(t.pef_qualified_rate)>=80&&parseFloat(t.drug_qualified_rate)>=80&&100==parseFloat(t.followup_qualified_rate),t.pastDue=Math.ceil(o.a.duration(o()(e).diff(o()())).as("day")),t.start_time&&(o()()>o()(e)?(t.days=90,Math.ceil(o.a.duration(o()(e).diff(o()(t.start_time))).as("day"))<89&&(t.days=Math.ceil(o.a.duration(o()(e).diff(o()(t.start_time))).as("day"))>0?Math.ceil(o.a.duration(o()(e).diff(o()(t.start_time))).as("day")):0)):t.days=Math.ceil(o.a.duration(o()().diff(o()(t.start_time))).as("day"))>0?Math.ceil(o.a.duration(o()().diff(o()(t.start_time))).as("day")):0)})),t.count_info=i.data.count_info,t.total_count=i.data.page_info_vo.total_count,t.tableLoading=!1;case 10:case"end":return e.stop()}}),e)})))()},handleSizeChange:function(t){this.size=t,this.fetchCarePlanRemind()},handleCurrentChange:function(t){this.page=t,this.fetchCarePlanRemind()},handledRadio:function(){var t=this,e=document.documentElement.clientWidth;this.table_height=0==this.radioKey?"calc(100vh - 288px)":e>=1920?"calc(100vh - 302px)":"calc(100vh - 345px)",this.handledReset(),sessionStorage.setItem("radioKey",this.radioKey),1==this.radioKey&&this.$nextTick((function(){t.$refs.elTable.doLayout()}))},handledSearch:function(){this.fetchCarePlanRemind()},handledOptions:function(){this.fetchCarePlanRemind()},handledReset:function(){if(0==this.radioKey){var t=new Date;t.setDate(t.getDate()+5),this.dateRange=[new Date,t]}if(1==this.radioKey){var e=new Date,n=new Date;e.setDate(1);var s=e.getFullYear(),a=e.getMonth()+1,i=new Date(s,a,0);n.setDate(i.getDate()),this.dateRange=[e,n]}this.searchResult="",this.isStandards="",this.isFollowUp="",this.fetchCarePlanRemind()},followCancel:function(){this.followUpVisible=!1,this.form={followUp:"",remark:""}},followConfirm:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=t.form.followUp){e.next=3;break}return t.$message({message:"请选择跟进情况",type:"warning"}),e.abrupt("return");case 3:return t.followUpVisible=!1,n={follow_remark:t.form.remark,follow_result:t.form.followUp,plan_id:t.plan_info.plan_id},e.next=7,t.$api.asthma.updata_follow_result(n);case 7:s=e.sent,a=s.data,t.form={followUp:"",remark:""},t.fetchCarePlanRemind(),0===a.errcode&&t.$message({message:"操作成功",type:"success"});case 12:case"end":return e.stop()}}),e)})))()},handledFollowUp:function(){this.form.remark=""},writeFllowResult:function(t){this.followUpVisible=!0,this.plan_info=t},copyText:function(t){var e=document.getElementById("input");e.value=t,e.select(),document.execCommand("Copy"),this.$message({type:"success",message:"复制成功"})},followTitle:function(t){var e="";return 1!=t&&2!=t&&3!=t&&4!=t||(e="跟进时间："),6==t&&(e="退货时间："),5==t&&(e="购买时间："),7==t&&(e="启动时间："),e},pushCarePlan:function(t){var e=this.$router.resolve({name:"caredetail",query:{id:t.plan_id,patient_id:t.patient_id,viewIndex:1,isFollow:t.subscribe_official_account}}),n=e.href;window.open(n,"_blank")},pushUseDetail:function(t){if(t.user_id){var e=this.$router.resolve({name:"scoreDetail",query:{id:t.user_id}}),n=e.href;window.open(n,"_blank")}},pushStorage:function(t){var e=this.$router.resolve({path:"/storage/detail/index",query:{sn_num:t.sn_num},meta:{title:"库存明细"}}),n=e.href;window.open(n,"_blank")}}},d=c,f=(n("cd3f"),n("2877")),h=Object(f["a"])(d,s,a,!1,null,"73120731",null);e["default"]=h.exports},d772:function(t,e,n){!function(e,n){t.exports=n()}(0,(function(){"use strict";var t,e,n=1e3,s=6e4,a=36e5,i=864e5,r=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=31536e6,l=2592e6,u=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,c={years:o,months:l,days:i,hours:a,minutes:s,seconds:n,milliseconds:1,weeks:6048e5},d=function(t){return t instanceof g},f=function(t,e,n){return new g(t,n,e.$l)},h=function(t){return e.p(t)+"s"},_=function(t){return t<0},p=function(t){return _(t)?Math.ceil(t):Math.floor(t)},m=function(t){return Math.abs(t)},w=function(t,e){return t?_(t)?{negative:!0,format:""+m(t)+e}:{negative:!1,format:""+t+e}:{negative:!1,format:""}},g=function(){function _(t,e,n){var s=this;if(this.$d={},this.$l=n,void 0===t&&(this.$ms=0,this.parseFromMilliseconds()),e)return f(t*c[h(e)],this);if("number"==typeof t)return this.$ms=t,this.parseFromMilliseconds(),this;if("object"==typeof t)return Object.keys(t).forEach((function(e){s.$d[h(e)]=t[e]})),this.calMilliseconds(),this;if("string"==typeof t){var a=t.match(u);if(a){var i=a.slice(2).map((function(t){return null!=t?Number(t):0}));return this.$d.years=i[0],this.$d.months=i[1],this.$d.weeks=i[2],this.$d.days=i[3],this.$d.hours=i[4],this.$d.minutes=i[5],this.$d.seconds=i[6],this.calMilliseconds(),this}}return this}var m=_.prototype;return m.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce((function(e,n){return e+(t.$d[n]||0)*c[n]}),0)},m.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=p(t/o),t%=o,this.$d.months=p(t/l),t%=l,this.$d.days=p(t/i),t%=i,this.$d.hours=p(t/a),t%=a,this.$d.minutes=p(t/s),t%=s,this.$d.seconds=p(t/n),t%=n,this.$d.milliseconds=t},m.toISOString=function(){var t=w(this.$d.years,"Y"),e=w(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var s=w(n,"D"),a=w(this.$d.hours,"H"),i=w(this.$d.minutes,"M"),r=this.$d.seconds||0;this.$d.milliseconds&&(r+=this.$d.milliseconds/1e3);var o=w(r,"S"),l=t.negative||e.negative||s.negative||a.negative||i.negative||o.negative,u=a.format||i.format||o.format?"T":"",c=(l?"-":"")+"P"+t.format+e.format+s.format+u+a.format+i.format+o.format;return"P"===c||"-P"===c?"P0D":c},m.toJSON=function(){return this.toISOString()},m.format=function(t){var n=t||"YYYY-MM-DDTHH:mm:ss",s={Y:this.$d.years,YY:e.s(this.$d.years,2,"0"),YYYY:e.s(this.$d.years,4,"0"),M:this.$d.months,MM:e.s(this.$d.months,2,"0"),D:this.$d.days,DD:e.s(this.$d.days,2,"0"),H:this.$d.hours,HH:e.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:e.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:e.s(this.$d.seconds,2,"0"),SSS:e.s(this.$d.milliseconds,3,"0")};return n.replace(r,(function(t,e){return e||String(s[t])}))},m.as=function(t){return this.$ms/c[h(t)]},m.get=function(t){var e=this.$ms,n=h(t);return"milliseconds"===n?e%=1e3:e="weeks"===n?p(e/c[n]):this.$d[n],0===e?0:e},m.add=function(t,e,n){var s;return s=e?t*c[h(e)]:d(t)?t.$ms:f(t,this).$ms,f(this.$ms+s*(n?-1:1),this)},m.subtract=function(t,e){return this.add(t,e,!0)},m.locale=function(t){var e=this.clone();return e.$l=t,e},m.clone=function(){return f(this.$ms,this)},m.humanize=function(e){return t().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},m.milliseconds=function(){return this.get("milliseconds")},m.asMilliseconds=function(){return this.as("milliseconds")},m.seconds=function(){return this.get("seconds")},m.asSeconds=function(){return this.as("seconds")},m.minutes=function(){return this.get("minutes")},m.asMinutes=function(){return this.as("minutes")},m.hours=function(){return this.get("hours")},m.asHours=function(){return this.as("hours")},m.days=function(){return this.get("days")},m.asDays=function(){return this.as("days")},m.weeks=function(){return this.get("weeks")},m.asWeeks=function(){return this.as("weeks")},m.months=function(){return this.get("months")},m.asMonths=function(){return this.as("months")},m.years=function(){return this.get("years")},m.asYears=function(){return this.as("years")},_}();return function(n,s,a){t=a,e=a().$utils(),a.duration=function(t,e){var n=a.locale();return f(t,{$l:n},e)},a.isDuration=d;var i=s.prototype.add,r=s.prototype.subtract;s.prototype.add=function(t,e){return d(t)&&(t=t.asMilliseconds()),i.bind(this)(t,e)},s.prototype.subtract=function(t,e){return d(t)&&(t=t.asMilliseconds()),r.bind(this)(t,e)}}}))}}]);