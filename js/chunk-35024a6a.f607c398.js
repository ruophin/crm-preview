(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35024a6a"],{3808:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"medicaldetails"},[i("div",{staticClass:"list-top"},[i("div",{staticClass:"list-top-left"},[e._v("内容基础信息")]),i("el-form",{ref:"form",staticClass:"w670 mt15 mb70",attrs:{model:e.form,rules:e.rules,"label-width":"auto"}},[i("el-form-item",{attrs:{label:"标题：",prop:"title"}},[e.isEdit?i("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}):i("span",[e._v(e._s(e.form.title))])],1),i("el-form-item",{attrs:{label:"封面图：",prop:"cover_url"}},[e.isEdit?i("p",[i("el-button",{attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:e.uploadClick}},[e._v(e._s(e.form.cover_url?"更 换":"上 传"))])],1):e._e(),e.form.cover_url?i("el-image",{staticStyle:{width:"312px",height:"200px","margin-top":"15px"},attrs:{src:e.form.cover_url,fit:"fill"}}):e._e()],1),i("el-form-item",{attrs:{label:"内容标签："}},[e._l(e.form.tags_list,(function(t){return i("el-tag",{key:t,staticClass:"mr10",attrs:{closable:e.isEdit,"disable-transitions":!1},on:{close:function(i){return e.handleCloseTag(t)}}},[e._v(" "+e._s(e.tagList.filter((function(e){return e.tag_id==t}))[0].name||"--")+" ")])})),e.isEdit?i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.tagDialog=!0}}},[e._v("添加")]):e._e()],2),i("el-form-item",{attrs:{label:"跳转位置：",prop:"type"}},[e.isEdit?i("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[i("el-radio",{attrs:{label:0}},[e._v("页面")]),i("el-radio",{attrs:{label:1}},[e._v("视频号")])],1):i("span",[e._v(e._s(e.form.type?"视频号":"页面"))])],1),e.form.type?[i("el-form-item",{attrs:{label:"视频号id：",prop:"video_mark"}},[e.isEdit?i("el-input",{model:{value:e.form.video_mark,callback:function(t){e.$set(e.form,"video_mark",t)},expression:"form.video_mark"}}):i("span",[e._v(e._s(e.form.video_mark))]),i("p",{staticClass:"gray"},[e._v("登录微信【视频号助手】，在首页可以查看自己的视频号ID")])],1),i("el-form-item",{attrs:{label:"视频id：",prop:"video"}},[e.isEdit?i("el-input",{model:{value:e.form.video,callback:function(t){e.$set(e.form,"video",t)},expression:"form.video"}}):i("span",[e._v(e._s(e.form.video))]),i("p",{staticClass:"gray"},[e._v("登录微信【视频号助手】，在「动态管理」模块可以复制自己发表的每个视频对应的视频id")])],1)]:[i("el-form-item",{attrs:{label:"链接：",prop:"link"}},[e.isEdit?i("el-input",{model:{value:e.form.link,callback:function(t){e.$set(e.form,"link",t)},expression:"form.link"}}):i("span",[e._v(e._s(e.form.link))])],1),i("el-form-item",{attrs:{label:"分享图：",prop:"small_img"}},[e.isEdit?i("p",[i("el-button",{attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:e.uploadShareClick}},[e._v(e._s(e.form.small_img?"更 换":"上 传"))])],1):e._e(),e.form.small_img?i("el-image",{staticStyle:{width:"250px",height:"200px","margin-top":"15px"},attrs:{src:e.form.small_img,fit:"fill"}}):e._e(),i("p",{staticClass:"gray"},[e._v("分享至微信及企微的图片大小比例为5:4")])],1)]],2)],1),e.isEdit?i("div",{staticClass:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.saveClick}},[e._v("保 存")])],1):e._e(),i("el-dialog",{attrs:{title:"内容标签",visible:e.tagDialog,width:"500px"},on:{"update:visible":function(t){e.tagDialog=t}}},[i("div",{staticClass:"flex mb16"},[i("span",{staticStyle:{"line-height":"32px"}},[e._v("创建新标签：")]),i("el-input",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{maxlength:"10",placeholder:"输入标签"},model:{value:e.newtag,callback:function(t){e.newtag=t},expression:"newtag"}}),i("el-button",{attrs:{type:"primary"},on:{click:e.addTagClick}},[e._v("添 加")])],1),e.tagList.length?i("p",[e._v("已有标签，请选择：")]):e._e(),i("div",{staticClass:"flex flex-wrap"},e._l(e.tagList,(function(t){return i("a",{key:t.tag_id,class:["tag",{active:e.lable.some((function(e){return e===t.tag_id}))}],on:{click:function(i){return e.tagClick(t.tag_id)}}},[e._v(e._s(t.name))])})),0),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.tagCancel}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.tagConfirm}},[e._v("保 存")])],1)]),i("el-dialog",{attrs:{title:"裁切封面",visible:e.cropperModel,width:"950px",center:""},on:{"update:visible":function(t){e.cropperModel=t}}},[i("cropper-image",{ref:"cropperImage",attrs:{Name:e.cropperName,width:312,height:200},on:{uploadImgSuccess:e.uploadImgSuccess}})],1),i("el-dialog",{attrs:{title:"裁切分享图",visible:e.cropperShareModel,width:"950px",center:""},on:{"update:visible":function(t){e.cropperShareModel=t}}},[i("cropper-image",{ref:"cropperShareImage",attrs:{Name:e.cropperName,width:250,height:200},on:{uploadImgSuccess:e.uploadShareImgSuccess}})],1)],1)},r=[],o=(i("c975"),i("d81d"),i("a434"),i("b0c0"),i("96cf"),i("1da1")),n=i("709f"),s={components:{CropperImage:n["a"]},data:function(){return{id:"",type:1,tagList:[],lable:[],weibanList:[],ditchkey:"",qy_qr_code:"",tag_id:"",ditchDialog:!1,tagDialog:!1,cropperModel:!1,cropperShareModel:!1,cropperName:"封面图",newtag:"",loading:!1,page:1,size:20,total:0,form:{title:"",cover_url:"",small_img:"",video_mark:"",video:"",link:"",remark:"",type:""},rules:{title:[{required:!0,message:"请输入内容名称",trigger:"blur"},{max:20,message:"内容名称在20个字符以内",trigger:"blur"}],cover_url:{required:!0,message:"请选择封面图",trigger:"blur"},small_img:{required:!0,message:"请选择分享图",trigger:"blur"},type:{required:!0,message:"请选择跳转位置",trigger:"blur"},link:{required:!0,message:"请输入页面链接",trigger:"blur"},video_mark:{required:!0,message:"请输入视频号ID",trigger:"blur"},video:{required:!0,message:"请输入视频ID",trigger:"blur"}}}},computed:{isEdit:function(){return"homeContent"!==this.$route.name},noMore:function(){return this.page>=Math.ceil(this.total/this.size)},disabled:function(){return this.loading||this.noMore}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.id=e.$route.params.id||"",t.next=3,e.getTagList();case 3:console.log(e.tagList),e.id&&(e.form=JSON.parse(sessionStorage.getItem("form")),e.form.tags_list=[],e.form.lable_list.map((function(t){t.name&&e.form.tags_list.push(t.tag_id)})),console.log(e.form),console.log(e.form.tags_list),e.lable=e.form.tags_list);case 5:case"end":return t.stop()}}),t)})))()},methods:{uploadClick:function(){var e=this;this.cropperModel=!0,this.$nextTick((function(){e.$refs.cropperImage.$refs["uploadBtn"].click()}))},uploadShareClick:function(){var e=this;this.cropperShareModel=!0,this.$nextTick((function(){e.$refs.cropperShareImage.$refs["uploadBtn"].click()}))},handleUploadSuccess:function(e){switch(console.log(e),e.name){case"flagImg":this.formValidate.mainImage="http://ydfblog.cn/dfs/"+e.url,console.log("最终输出"+e.name);break}this.cropperModel=!1},tagConfirm:function(){this.form.tags_list=this.lable,this.tagDialog=!1},tagCancel:function(){this.tagDialog=!1},addTagClick:function(){this.newtag?(this.addTag(this.newtag),this.newtag=""):this.$message({type:"error",message:"标签不能为空"})},tagClick:function(e){this.lable.indexOf(e)>-1?this.lable.splice(this.lable.indexOf(e),1):this.lable.push(e)},handleCloseTag:function(e){this.lable.splice(this.lable.indexOf(e),1)},saveClick:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.id?e.update():e.save()}))},getTagList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.baseContent.queryContentTags({});case 2:i=t.sent,a=i.data,0===a.errcode&&(e.tagList=a.data);case 5:case"end":return t.stop()}}),t)})))()},addTag:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var a,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.$api.baseContent.addTag({name:e});case 2:a=i.sent,r=a.data,0===r.errcode&&t.getTagList();case 5:case"end":return i.stop()}}),i)})))()},update:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.baseContent.update(e.form);case 2:i=t.sent,a=i.data,0===a.errcode&&(e.$message({type:"success",message:"保存成功"}),e.$router.push("/cms/store/index"));case 5:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.baseContent.add(e.form);case 2:i=t.sent,a=i.data,0===a.errcode&&(e.$message({type:"success",message:"添加成功"}),e.$router.push("/cms/store/index"));case 5:case"end":return t.stop()}}),t)})))()},load:function(){this.page++,this.getWeibanList()},uploadImgSuccess:function(e){this.cropperModel=!1,this.form.cover_url=e},uploadShareImgSuccess:function(e){this.cropperShareModel=!1,this.form.small_img=e}}},l=s,c=(i("b14e"),i("2877")),u=Object(c["a"])(l,a,r,!1,null,"e3044bf0",null);t["default"]=u.exports},"80bc":function(e,t,i){},b14e:function(e,t,i){"use strict";var a=i("80bc"),r=i.n(a);r.a},e766:function(e,t,i){"use strict";i("b0c0");var a=i("bc3a"),r=i.n(a),o={qiniuRegion:"",qiniuImageURLPrefix:"",qiniuUploadToken:"",qiniuUploadTokenURL:"",qiniuUploadTokenFunction:null};function n(e){o={qiniuRegion:"",qiniuImageURLPrefix:"",qiniuUploadToken:"",qiniuUploadTokenURL:"",qiniuUploadTokenFunction:null},s(e)}function s(e){e.region?o.qiniuRegion=e.region:console.error("qiniu uploader need your bucket region"),e.uptoken?o.qiniuUploadToken=e.uptoken:e.uptokenURL?o.qiniuUploadTokenURL=e.uptokenURL:e.uptokenFunc&&(o.qiniuUploadTokenFunction=e.uptokenFunc),e.domain&&(o.qiniuImageURLPrefix=e.domain)}function l(e,t,i,a){if(null!=e)if(a&&n(a),o.qiniuUploadToken)c(e,t,i,a);else if(o.qiniuUploadTokenURL)u((function(){c(e,t,i,a)}));else{if(!o.qiniuUploadTokenFunction)return void console.error("qiniu uploader need one of [uptoken, uptokenURL, uptokenFunc]");o.qiniuUploadToken=o.qiniuUploadTokenFunction()}else console.error("qiniu uploader need filePath to upload")}function c(e,t,i,a){var n=p(o.qiniuRegion),s=e.name;a&&a.key&&(s=a.key);var l=new window.FormData;l.append("token",o.qiniuUploadToken),l.append("key",s),l.append("file",e),r.a.post(n,l).then((function(e){t&&t(e)})).catch((function(e){i(e),console.log(e)}))}function u(e){r.a.get(o.qiniuUploadTokenURL).then((function(t){var i=t.data.uptoken;o.qiniuUploadToken=i,e&&e()})).catch((function(e){console.log(e)}))}function p(e){var t=null;switch(e){case"ECN":t="https://up.qbox.me";break;case"NCN":t="https://up-z1.qbox.me";break;case"SCN":t="https://up-z2.qbox.me";break;case"NA":t="https://up-na0.qbox.me";break;default:console.error("please make the region is with one of [ECN, SCN, NCN, NA]")}return t}t["a"]={init:n,upload:l}}}]);