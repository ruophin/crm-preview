(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0bd62e68"],{"4b6d":function(e,t,r){"use strict";var i=r("fb6b"),o=r.n(i);o.a},"6a5f":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"patientmgmt"},[r("div",{staticClass:"header-box",staticStyle:{padding:"6px 20px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{staticStyle:{margin:"8px 0",float:"right"},attrs:{span:6}},[r("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-plus"},on:{click:e.add}},[e._v("添加资源")])],1)],1)],1),r("div",{staticStyle:{margin:"0 16px"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"elTable",attrs:{data:e.tableData,size:"small",border:"",stripe:"",height:"calc(100vh - 213px)"}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center",index:function(e){return e+1}}}),r("el-table-column",{attrs:{label:"资源信息","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{},[r("el-image",{attrs:{src:t.row.resources_url,fit:"cover"}}),r("div",{staticClass:"ml20"},[r("h3",[e._v(e._s(t.row.name||"--"))]),r("p",[e._v("跳转到："+e._s(e.sourceType[t.row.type]))]),0==t.row.type?r("p",[e._v(" 页面地址："+e._s(t.row&&t.row.page_address&&t.row.page_address.slice(0,40)+"…"||"--")),r("a",{staticClass:"ml10 blue",on:{click:function(r){return e.copyText(t.row.page_address)}}},[e._v("复制")])]):e._e(),1==t.row.type?r("p",[e._v("小程序APPID："+e._s(t.row.mini_program_appid||"--")),r("a",{staticClass:"ml10 blue",on:{click:function(r){return e.copyText(t.row.mini_program_appid)}}},[e._v("复制")])]):e._e(),1==t.row.type?r("p",[e._v("小程序路径："+e._s(t.row.mini_program_url||"--")),r("a",{staticClass:"ml10 blue",on:{click:function(r){return e.copyText(t.row.mini_program_url)}}},[e._v("复制")])]):e._e(),2==t.row.type?r("p",[e._v("视频号ID："+e._s(t.row.video_num_id||"--")),r("a",{staticClass:"ml10 blue",on:{click:function(r){return e.copyText(t.row.video_num_id)}}},[e._v("复制")])]):e._e(),2==t.row.type?r("p",[e._v("视频ID："+e._s(t.row.video_id||"--")),r("a",{staticClass:"ml10 blue",on:{click:function(r){return e.copyText(t.row.video_id)}}},[e._v("复制")])]):e._e(),r("p",{staticClass:"mt15"},[e._v("创建时间："+e._s(t.row.sys_create_time||"--"))]),r("p",[e._v("创建者："+e._s(t.row.sys_create_name||"--"))])])],1)]}}])}),r("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.edit(t.row)}}},[e._v("编辑")]),t.$index>0?r("el-link",{staticStyle:{"margin-left":"13px"},attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.move(t.row.resources_id,-1)}}},[e._v("上移 ")]):e._e(),t.$index<e.tableData.length-1?r("el-link",{staticStyle:{"margin-left":"13px"},attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.move(t.row.resources_id,1)}}},[e._v("下移 ")]):e._e(),r("el-link",{staticStyle:{"margin-left":"13px"},attrs:{underline:!1,type:"danger"},on:{click:function(r){return e.deleteClick(t.row.resources_id)}}},[e._v("删除 ")])]}}])})],1)],1),r("el-dialog",{attrs:{title:e.form.resources_id?"编辑资源":"新建资源",visible:e.editDialog},on:{"update:visible":function(t){e.editDialog=t}}},[r("div",[r("el-form",{ref:"elForm",attrs:{"label-width":"auto",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"图片/icon",prop:"resources_url"}},[r("p",[r("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:e.uploadClick}},[e._v(e._s(e.form.resources_url?"更 换":"上 传")+" ")])],1),e.form.resources_url?r("el-image",{staticStyle:{width:"344px",height:"120px","margin-top":"15px"},attrs:{src:e.form.resources_url,fit:"fill"}}):e._e()],1),r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{attrs:{maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"跳转位置",prop:"type"}},[r("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[r("el-radio",{attrs:{label:0}},[e._v("页面")]),r("el-radio",{attrs:{label:1}},[e._v("小程序")]),r("el-radio",{attrs:{label:2}},[e._v("视频号")])],1)],1),e.form.type?e._e():[r("el-form-item",{attrs:{label:"页面地址：",prop:"page_address"}},[r("el-input",{model:{value:e.form.page_address,callback:function(t){e.$set(e.form,"page_address",t)},expression:"form.page_address"}})],1),r("el-form-item",{attrs:{label:"分享图：",prop:"small_img"}},[r("p",[r("el-button",{attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:e.uploadShareClick}},[e._v(" "+e._s(e.form.small_img?"更 换":"上 传")+" ")])],1),e.form.small_img?r("el-image",{staticStyle:{width:"250px",height:"200px","margin-top":"15px"},attrs:{src:e.form.small_img,fit:"fill"}}):e._e(),r("p",{staticClass:"gray"},[e._v("分享至微信及企微的图片大小比例为5:4")])],1)],1===e.form.type?[r("el-form-item",{attrs:{label:"小程序APPID：",prop:"mini_program_appid"}},[r("el-input",{model:{value:e.form.mini_program_appid,callback:function(t){e.$set(e.form,"mini_program_appid",t)},expression:"form.mini_program_appid"}})],1),r("el-form-item",{attrs:{label:"小程序路径：",prop:"mini_program_url"}},[r("el-input",{model:{value:e.form.mini_program_url,callback:function(t){e.$set(e.form,"mini_program_url",t)},expression:"form.mini_program_url"}})],1)]:e._e(),2===e.form.type?[r("el-form-item",{attrs:{label:"视频号ID：",prop:"video_num_id"}},[r("el-input",{model:{value:e.form.video_num_id,callback:function(t){e.$set(e.form,"video_num_id",t)},expression:"form.video_num_id"}}),r("span",[e._v("登录微信【视频号助手】，在首页可以查看自己的视频号ID")])],1),r("el-form-item",{attrs:{label:"视频ID：",prop:"video_id"}},[r("el-input",{model:{value:e.form.video_id,callback:function(t){e.$set(e.form,"video_id",t)},expression:"form.video_id"}}),r("span",[e._v("登录微信【视频号助手】，在「动态管理」模块可以复制自己发表的每个视频对应的视频ID")])],1),r("el-form-item",{attrs:{label:"分享图：",prop:"small_img"}},[r("p",[r("el-button",{attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:e.uploadShareClick}},[e._v(" "+e._s(e.form.small_img?"更 换":"上 传")+" ")])],1),e.form.small_img?r("el-image",{staticStyle:{width:"250px",height:"200px","margin-top":"15px"},attrs:{src:e.form.small_img,fit:"fill"}}):e._e(),r("p",{staticClass:"gray"},[e._v("分享至微信及企微的图片大小比例为5:4")])],1)]:e._e()],2)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("保 存")])],1)]),r("el-dialog",{attrs:{title:"裁切资源封面图",visible:e.cropperModel,width:"1150px",center:""},on:{"update:visible":function(t){e.cropperModel=t}}},[r("cropper-image",{ref:"cropperImage",attrs:{Name:"封面图",width:688,height:240},on:{uploadImgSuccess:e.uploadImgSuccess}})],1),r("el-dialog",{attrs:{title:"裁切分享图",visible:e.cropperShareModel,width:"950px",center:""},on:{"update:visible":function(t){e.cropperShareModel=t}}},[r("cropper-image",{ref:"cropperShareImage",attrs:{Name:"分享图",width:250,height:200},on:{uploadImgSuccess:e.uploadShareImgSuccess}})],1),r("input",{staticStyle:{position:"absolute",left:"-999px"},attrs:{type:"text",id:"input"}})],1)},o=[],a=(r("96cf"),r("1da1")),n=r("709f"),s={components:{CropperImage:n["a"]},data:function(){return{tableLoading:!1,tableData:[],editDialog:!1,cropperModel:!1,cropperShareModel:!1,form:{name:"",type:0,resources_url:"",small_img:"",page_address:"",mini_program_appid:"",mini_program_url:"",video_num_id:"",video_id:""},rules:{resources_url:[{required:!0,message:"请选择封面图",trigger:"blur"}],small_img:[{required:!0,message:"请选择分享图",trigger:"blur"}],name:[{required:!0,message:"请输入内容名称",trigger:"blur"}],type:[{required:!0,message:"请选择跳转位置",trigger:"blur"}],page_address:[{required:!0,message:"请输入页面链接",trigger:"blur"}],mini_program_appid:[{required:!0,message:"请输入小程序APPID",trigger:"blur"}],mini_program_url:[{required:!0,message:"请输入小程序路径",trigger:"blur"}],video_num_id:[{required:!0,message:"请输入视频号id",trigger:"blur"}],video_id:[{required:!0,message:"请输入视频id",trigger:"blur"}]},sourceType:["页面","小程序","视频号"]}},created:function(){this.getData()},methods:{getData:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.resources.getResourcesList({location_id:e.$route.params.id,page:1,size:10});case 2:r=t.sent,i=r.data,0==i.errcode&&(e.tableData=i.data.list),e.tableLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},addResource:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.resources.add(e.form);case 2:r=t.sent,i=r.data,0==i.errcode&&(e.$message({type:"success",message:"添加成功"}),e.getData());case 5:case"end":return t.stop()}}),t)})))()},update:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.resources.update(e.form);case 2:r=t.sent,i=r.data,0==i.errcode&&(e.$message({type:"success",message:"编辑成功"}),e.getData());case 5:case"end":return t.stop()}}),t)})))()},deleteResource:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$api.resources.deleteResources(e);case 2:i=r.sent,o=i.data,0==o.errcode&&(t.$message({type:"success",message:"删除资源成功"}),t.getData());case 5:case"end":return r.stop()}}),r)})))()},move:function(e,t){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function i(){var o,a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,r.$api.resources.move(e,t);case 2:o=i.sent,a=o.data,0==a.errcode&&r.getData();case 5:case"end":return i.stop()}}),i)})))()},edit:function(e){this.editDialog=!0,this.form=JSON.parse(JSON.stringify(e))},add:function(){this.form={},this.editDialog=!0},confirm:function(){var e=this;this.$refs["elForm"].validate((function(t){if(!t)return!1;e.form.resources_id?e.update():e.addResource(),e.editDialog=!1}))},cancel:function(){this.editDialog=!1},deleteClick:function(e){var t=this;this.$confirm("是否确认删除资源?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteResource(e)})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},copyText:function(e){var t=document.getElementById("input");t.value=e,t.select(),document.execCommand("Copy"),this.$message({type:"success",message:"复制成功"})},uploadImgSuccess:function(e){this.cropperModel=!1,this.form.resources_url=e},uploadClick:function(){var e=this;this.cropperModel=!0,this.$nextTick((function(){e.$refs.cropperImage.$refs["uploadBtn"].click()}))},uploadShareImgSuccess:function(e){this.cropperShareModel=!1,this.form.small_img=e},uploadShareClick:function(){var e=this;this.cropperShareModel=!0,this.$nextTick((function(){e.$refs.cropperShareImage.$refs["uploadBtn"].click()}))}}},l=s,u=(r("4b6d"),r("2877")),c=Object(u["a"])(l,i,o,!1,null,"676b8a00",null);t["default"]=c.exports},e766:function(e,t,r){"use strict";r("b0c0");var i=r("bc3a"),o=r.n(i),a={qiniuRegion:"",qiniuImageURLPrefix:"",qiniuUploadToken:"",qiniuUploadTokenURL:"",qiniuUploadTokenFunction:null};function n(e){a={qiniuRegion:"",qiniuImageURLPrefix:"",qiniuUploadToken:"",qiniuUploadTokenURL:"",qiniuUploadTokenFunction:null},s(e)}function s(e){e.region?a.qiniuRegion=e.region:console.error("qiniu uploader need your bucket region"),e.uptoken?a.qiniuUploadToken=e.uptoken:e.uptokenURL?a.qiniuUploadTokenURL=e.uptokenURL:e.uptokenFunc&&(a.qiniuUploadTokenFunction=e.uptokenFunc),e.domain&&(a.qiniuImageURLPrefix=e.domain)}function l(e,t,r,i){if(null!=e)if(i&&n(i),a.qiniuUploadToken)u(e,t,r,i);else if(a.qiniuUploadTokenURL)c((function(){u(e,t,r,i)}));else{if(!a.qiniuUploadTokenFunction)return void console.error("qiniu uploader need one of [uptoken, uptokenURL, uptokenFunc]");a.qiniuUploadToken=a.qiniuUploadTokenFunction()}else console.error("qiniu uploader need filePath to upload")}function u(e,t,r,i){var n=p(a.qiniuRegion),s=e.name;i&&i.key&&(s=i.key);var l=new window.FormData;l.append("token",a.qiniuUploadToken),l.append("key",s),l.append("file",e),o.a.post(n,l).then((function(e){t&&t(e)})).catch((function(e){r(e),console.log(e)}))}function c(e){o.a.get(a.qiniuUploadTokenURL).then((function(t){var r=t.data.uptoken;a.qiniuUploadToken=r,e&&e()})).catch((function(e){console.log(e)}))}function p(e){var t=null;switch(e){case"ECN":t="https://up.qbox.me";break;case"NCN":t="https://up-z1.qbox.me";break;case"SCN":t="https://up-z2.qbox.me";break;case"NA":t="https://up-na0.qbox.me";break;default:console.error("please make the region is with one of [ECN, SCN, NCN, NA]")}return t}t["a"]={init:n,upload:l}},fb6b:function(e,t,r){}}]);